# Chapter 05 Experiment Report

## 实验目的

1. 实现四阶泰勒展开法对常微分方程初值问题进行数值求解，并验证其精度。
2. 实现经典四阶 Runge-Kutta 方法，观察当步数增加时误差的变化规律。
3. 实现四阶 Adams-Bashforth-Moulton 预测-校正（PECE）算法，比较多步法与单步法在同一问题上的表现。

## 问题与方法概述

- **问题 1**：
  - 微分方程：$y' = y - x^2 + 1$, $y(0) = 0.5$
  - 精确解：$y(x) = (x+1)^2 - \tfrac{1}{2} e^x$
  - 数值方法：四阶泰勒展开法，步长 $h = 0.1$，计算至 $x = 0.5$
- **问题 2**：
  - 共三个方程，均在区间 $[0,1]$ 上求解，使用 RK4 方法分别取 $N = 5, 10, 20$ 个等分步长。
  - 方程与精确解：
    1. $y' = x + y$, $y(0) = 1$, $y(x) = -x-1 + 2e^x$
    2. $y' = x - y$, $y(0) = 1$, $y(x) = x-1 + 2e^{-x}$
    3. $y' = y - x^2 + 1$, $y(0) = 0.5$, $y(x) = (x+1)^2 - \tfrac{1}{2} e^x$
- **问题 3**：
  - 使用与问题 2 相同的三个方程，在 $[0,1]$ 上采用 $h = 0.1$ 的四阶 Adams-Bashforth-Moulton PECE 算法。
  - 首三个节点通过 RK4 预热以提供多步法所需初值。

## 实验结果

### 问题 1：泰勒展开法

| x  | 数值解 (Taylor) | 精确解 | 绝对误差 |
|----|-----------------|--------|----------|
| 0.0 | 0.5000000000 | 0.5000000000 | 0.00e+00 |
| 0.5 | 1.4256396807 | 1.4256393646 | 3.16e-07 |

泰勒法在整个区间内的误差保持在 $10^{-7}$ 量级，验证了解析导数带来的高精度。

### 问题 2：Runge-Kutta 方法

表格给出每个问题在 $x = 1$ 处的绝对误差随步数 $N$ 的变化。

| 问题 | $N=5$ | $N=10$ | $N=20$ |
|------|-------|--------|--------|
| (1) $y' = x + y$ | $6.14 \times 10^{-5}$ | $4.17 \times 10^{-6}$ | $2.72 \times 10^{-7}$ |
| (2) $y' = x - y$ | $1.16 \times 10^{-5}$ | $6.67 \times 10^{-7}$ | $4.00 \times 10^{-8}$ |
| (3) $y' = y - x^2 + 1$ | $3.64 \times 10^{-5}$ | $2.36 \times 10^{-6}$ | $1.50 \times 10^{-7}$ |

可以看到，当步长减半（步数加倍）时误差约下降一个数量级，符合四阶 RK 方法的理论收敛阶。

### 问题 3：Adams PECE 方法

使用 $h = 0.1$ 在 $x = 1$ 处得到如下误差：

| 问题 | 绝对误差 |
|------|----------|
| (1) $y' = x + y$ | $3.58 \times 10^{-6}$ |
| (2) $y' = x - y$ | $2.15 \times 10^{-6}$ |
| (3) $y' = y - x^2 + 1$ | $2.29 \times 10^{-6}$ |

PECE 方法在相同步长下的精度略逊于 RK4（$h = 0.1$ 时 RK4 的误差约 $10^{-6}$ 量级），但仍保持四阶收敛特性。

## 结果分析

1. 四阶泰勒法依赖解析高阶导数，计算量较大但数值误差极小，适合有显式高阶导数公式的方程。
2. RK4 作为单步法实现简单、稳定性好，只需计算函数值即可取得高精度，是常见的通用选择。
3. Adams 多步法在给定步长下的误差略高于 RK4，原因在于预测-校正依赖历史值，对误差累积更敏感。但若减少函数评估次数（每步仅 2 次），在大规模问题中具有计算效率优势。
4. 所有方法都验证了理论阶数：当步长减半时，误差大约缩小 $2^4 = 16$ 倍。

## 结论

通过实现三种常见的常微分方程初值问题数值方法，验证了它们的精度表现及各自适用的场景。泰勒法最精确但需求最高阶导数，RK4 平衡了精度与实现复杂度，而 Adams 多步法在函数评估昂贵时可以作为有效替代方案。
