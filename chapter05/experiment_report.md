# Chapter 05 实验报告：Romberg 积分计算

## 一、实验目的
1. 掌握龙贝格积分（Romberg integration）的基本思想和实现步骤。
2. 编写程序求解以下定积分的近似值：
   1. $\int_{0}^{100} x^3\,dx$
   2. $\int_{0}^{1} \dfrac{\sin x}{x}\,dx$
   3. $\int_{0}^{1} \sin(x^2)\,dx$
3. 通过数表分析龙贝格算法的收敛过程和误差特性。

## 二、实验原理
龙贝格积分是一种基于梯形公式和理查森外推的高精度数值积分方法。其核心思想是：
1. 先使用复合梯形公式得到一系列逐步加密区间的粗略积分值；
2. 运用理查森外推公式消除截断误差的主导项，从而快速提高精度；
3. 构造出一个下三角的 Romberg 表，表的对角线元素逐步逼近真实积分值。

外推公式为
$$R_{k,j} = R_{k,j-1} + \frac{R_{k,j-1} - R_{k-1,j-1}}{4^j - 1},$$
其中 $R_{k,0}$ 为复合梯形公式的结果，$j$ 表示外推次数。通过对角线元素 $R_{k,k}$ 的变化可以判定是否已经达到预设精度。

## 三、实验环境
- Python 3.11
- 无外部依赖，仅使用标准库 `math`。

## 四、程序设计与实现
每个问题单独编写一个 Python 程序，均包含以下核心步骤：
1. 定义待积分的被积函数。
2. 实现通用的 `romberg_integration` 函数，输入为函数指针、积分上下限、最大层数和收敛判据。
3. 在主函数中调用龙贝格积分，输出 Romberg 表和最终结果。
4. 对于第二个积分，特别处理 $x=0$ 处的可去奇点，使用极限值 $\lim_{x\to 0} \sin x / x = 1$。

## 五、实验结果与分析
1. **问题（1）**：Romberg 表在第 3 行（层数 2）即得到精确结果 $2.5\times10^{7}$，误差为 0。这与积分被积函数为多项式且龙贝格对多项式具有高阶精度的特性一致。
2. **问题（2）**：对角线元素迅速收敛到 $0.9460830704$，相邻两行结果差约 $10^{-9}$，说明在较少层数下即可获得高精度结果。
3. **问题（3）**：由于被积函数振荡且无解析初等原函数，Romberg 表在层数 6 处仍能稳定到 $10^{-10}$ 量级的变化，表现出良好的收敛性。

详细数值见《Chapter 05 数表》。可以观察到：
- 每一层的第一列（复合梯形）收敛缓慢，而通过外推后的后几列变化显著减小；
- 对角线元素 $R_{k,k}$ 的稳定性可以作为停止准则；
- 被积函数越光滑，Romberg 积分收敛越快。

## 六、结论
实验验证了龙贝格积分在处理不同类型的定积分时的有效性：
- 对多项式积分可得到精确值；
- 对含有可去奇点的函数可以通过适当处理获得高精度结果；
- 对无解析原函数的振荡型函数仍能保持良好的收敛速度。

通过本次实验，加深了对梯形公式、理查森外推以及 Romberg 表构造方法的理解。
