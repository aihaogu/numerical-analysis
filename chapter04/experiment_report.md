# Chapter 04 Experiment Report

## 实验目的

1. 学习并实现多项式最小二乘法，利用其对实验测量数据进行拟合。
2. 通过程序自动化求解正规方程，并输出拟合多项式、残差和误差指标。

## 数据描述

实验数据来自教材表 6，共 7 组 $x_i$ 与 $f_i$：

| $i$ | $x_i$ | $f_i$ |
| --- | ---- | ----- |
| 1 | 1 | 2.01 |
| 2 | 3 | 2.98 |
| 3 | 4 | 3.50 |
| 4 | 5 | 5.05 |
| 5 | 7 | 5.47 |
| 6 | 8 | 6.02 |
| 7 | 9 | 7.05 |

数据总体呈现上升趋势，但并非严格线性，适合用多项式最小二乘法进行拟合。

## 算法与实现

- 设拟合多项式为
  \[
  p_m(x) = c_0 + c_1 x + c_2 x^2 + \cdots + c_m x^m,
  \]
  将每一个数据点 $(x_i, f_i)$ 带入可得正规方程组
  \[
  (A^\mathsf{T}A)\,c = A^\mathsf{T}f,
  \]
  其中 $A$ 的第 $i$ 行为 $[1, x_i, x_i^2, \ldots, x_i^m]$。
- 程序首先预计算 $\sum x_i^k$ 和 $\sum f_i x_i^k$，构造对称矩阵 $A^\mathsf{T}A$ 及右端向量 $A^\mathsf{T}f$。
- 为提高数值稳定性，使用带列主元选取策略的高斯消去法求解线性方程组。
- 提供命令行参数 `--degree` 控制多项式阶数，默认取二次多项式。

源代码见 `problem1_least_squares.py`，运行方式示例：

```bash
python chapter04/problem1_least_squares.py
# 或指定一次拟合
python chapter04/problem1_least_squares.py --degree 1
```

## 实验结果

以默认的二次多项式拟合，得到系数：

\[
\begin{aligned}
 c_0 &= 1.321989, \\
 c_1 &= 0.615411, \\
 c_2 &= 2.28\times 10^{-4}.
\end{aligned}
\]

拟合多项式为 $p(x) = 1.321989 + 0.615411 x + 0.000228 x^2$。将结果代入各个测量点，得到如下对比：

| $x_i$ | $f_i$ | $p(x_i)$ | 残差 $f_i - p(x_i)$ |
| ---- | ----- | -------- | ------------------ |
| 1 | 2.01 | 1.9376 | 0.0724 |
| 3 | 2.98 | 3.1703 | -0.1903 |
| 4 | 3.50 | 3.7873 | -0.2873 |
| 5 | 5.05 | 4.4047 | 0.6453 |
| 7 | 5.47 | 5.6410 | -0.1710 |
| 8 | 6.02 | 6.2599 | -0.2399 |
| 9 | 7.05 | 6.8792 | 0.1708 |

误差指标：

- 残差平方和（SSE）：$0.656306$
- 均方根误差（RMSE）：$0.306199$

此外，将拟合阶数改为一次多项式时，系数变为 $c_0 = 1.317630, c_1 = 0.617746$，对应的 SSE 仅略增至 $0.656320$，说明二次项贡献极小，数据整体更接近一次线性趋势。

## 结果分析

- 通过正规方程与高斯消去法顺利获得拟合多项式，程序可扩展至更高阶或其他数据集。
- 二次项的系数数量级为 $10^{-4}$，对拟合结果影响甚微，说明实验数据基本遵循线性关系。
- 拟合误差集中在 $x=5$ 附近，可能由测量误差或实验条件变化导致。

## 结论

最小二乘法能够有效处理表 6 的实验数据，给出清晰的趋势模型。程序结构化实现了正规方程求解及误差分析，可作为后续实验的基础工具，也提示在拟合模型时应结合数据特点选择合适的多项式阶数。
