# 第三章实验报告

## 问题描述
本章考虑 Runge 函数
\[
    f(x) = \frac{1}{1 + 25x^2}, \qquad x \in [-1, 1]
\]
在等距节点 \(x_j = -1 + 2j/N\) 上的插值问题。教材提出以下实验任务：

1. 构造通过 11 个等距节点的 10 次插值多项式 \(\varphi_{10}(x)\)，观察插值误差的变化。
2. 采用分段线性插值，比较不同节点数下的精度。
3. 构造满足自然边界条件 \(S_N''(x_0) = S_N''(x_N) = 0\) 的三次样条插值。
4. 构造满足端点导数条件 \(S_N'(x_0) = f'(x_0),\; S_N'(x_N) = f'(x_N)\) 的三次样条插值。

所有 Python 代码均保存在 `chapter03` 文件夹下，每个问题一个脚本。

## 实验方法
- **问题 1** 使用重心拉格朗日公式稳定地计算 \(\varphi_{10}(x)\)，在 1001 个均匀采样点评估误差，并挑选代表性点比较插值值与原函数值。
- **问题 2** 使用分段线性插值函数，在密集采样点上评估最大绝对误差和均方根（RMS）误差，节点数取 \(N=10,20,40\)。
- **问题 3** 先求解三对角线性方程得到自然样条的二阶导数，再按分段公式计算样条值，同样在密集采样点评估误差。
- **问题 4** 在三对角系统中引入端点导数条件，求得夹持样条的二阶导数后评估误差，与自然样条进行对比。

## 实验结果
- **高次插值误差**：\(\varphi_{10}(x)\) 的最大绝对误差出现在靠近边界的 \(x=-0.94\)，达到 1.92（插值值 1.96，而真实值仅 0.043）。这印证了 Runge 现象在等距节点上的不稳定性。
- **分段与样条插值误差对比**：

| N  | 分段线性 max\(|e|\) | 分段线性 RMS | 自然样条 max\(|e|\) | 自然样条 RMS | 夹持样条 max\(|e|\) | 夹持样条 RMS |
|----|----------------------|----------------|-----------------------|----------------|-----------------------|----------------|
| 10 | 6.7442e-02           | 2.3910e-02     | 2.1974e-02            | 7.1562e-03     | 2.1972e-02            | 7.1499e-03     |
| 20 | 4.1834e-02           | 1.0488e-02     | 3.1828e-03            | 8.7894e-04     | 3.1828e-03            | 8.7863e-04     |
| 40 | 1.4040e-02           | 2.7407e-03     | 2.7797e-04            | 4.9466e-05     | 2.7797e-04            | 4.9291e-05     |

可以看到，三次样条的误差远小于分段线性插值，且自然样条与夹持样条的数值表现几乎一致。

## 结论
- 等距节点的高次拉格朗日插值对 Runge 函数非常不稳定，靠近区间端点误差巨大。
- 分段线性插值随节点增多能逐渐降低误差，但收敛速度有限。
- 三次样条插值（无论自然还是夹持边界条件）在同样的节点数下拥有显著更高的精度，是处理该类函数的更好选择。

上述结论与教材中关于 Runge 现象与样条优势的分析相吻合。
